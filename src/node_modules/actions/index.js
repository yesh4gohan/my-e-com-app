import {
    FETCH_PHONES_START,
    FETCH_PHONES_SUCCESS,
    FETCH_PHONES_FAILURE,
    LOAD_PHONES_FAILURE,
    LOAD_PHONES_START,
    LOAD_PHONES_SUCCESS
  } from 'actionTypes';

import {fetchPhones as fetchPhonesApi,loadMorePhones as loadMorePhonesApi} from "api";
const PRODUCTS_PER_PAGE = 3;

export const fetchPhones = () => async dispatch => {
    dispatch({type:FETCH_PHONES_START});
    try {
        const phones = await fetchPhonesApi();
        const phones_per_page = phones.filter((phone) =>phone.id <= PRODUCTS_PER_PAGE);
        dispatch({
            type:FETCH_PHONES_SUCCESS,
            payload:phones_per_page
        })

    } catch (error) {
        dispatch({
            type:FETCH_PHONES_FAILURE,
            payload:error,
            error:true
        })
    }
}

export const loadMorePhones = (products_count) => async dispatch=>{
    dispatch({
        type:LOAD_PHONES_START
    });
    try {
        const phones = await loadMorePhonesApi();
        const phones_per_page = phones.filter((phone)=>(phone.id>products_count && phone.id<=products_count+PRODUCTS_PER_PAGE))
        //console.log(phones_per_page);
        dispatch({
            type:LOAD_PHONES_SUCCESS,
            payload:phones_per_page
        });
    } catch (error) {
        dispatch({
            type:LOAD_PHONES_FAILURE,
            payload:error,
            error:true
        });
    }
}

