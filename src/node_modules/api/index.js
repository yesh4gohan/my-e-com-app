import phones from "./mockPhones";
import { API } from "aws-amplify";

export const fetchPhones = async () => {
  let myInit = {
    response: true,
}

 return API.get("shopping-cart","/products/all",myInit)//three params resource name, endpoint, request body
.then(res=>{return res.data})
.catch(err => console.log(err));
};

// export const loadMorePhones = async () => {
//   return new Promise((resolve, reject) => {
//     resolve(phones);
//   });
// };

export const fetchPhoneById = async id => {
  let myInit = {
    response: true,
}
  return API.get("shopping-cart",`/products/${id}`,myInit)
        .then(res=>{return res.data})
        .catch(err=>console.log(err))
};

//take each product
//modify productid
//take each attribute of object and attach it to request body
//push each to table item by giving 2 seconds delay

export const pushToDynamodb = () => {
  phones.map((phone,index) => {
    phone.productId = `product_${Math.floor(100000 + Math.random() * 900000)}`;
    Object.assign(phone,phone,{productNumber:index+1})
    //console.log(phone)
    const payload = {
      body: {
        'productNumber':phone.productNumber,
        'productId': phone.productId,
        'name': phone.name,
        'description': phone.description,
        'price': phone.price.toString(),
        'image':phone.image,
        'cpu': phone.cpu,
        'camera': phone.camera,
        'size': phone.size,
        'weight': phone.weight,
        'battery': phone.battery,
        'display': phone.display,
        'memory': phone.memory
      }
    };

    API.post("shopping-cart", "/products", payload)
    .then(res => console.log(res))
    .catch(err => console.log(err));

    
  });
};
